#!/bin/sh

# Run this script immediately after cloning the codebase.

DEFAULT_PORT=3000

# Set up npm dependencies
npm install -g nodemon
npm install

DIR=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )
cd $DIR/..

# Set up configurable environment variables for Foreman
if [ ! -f .env ]; then
  echo "NODE_ENV=development" > .env
  echo "PORT=$DEFAULT_PORT" >> .env
fi

# Create and migrate the database
createuser -s KALE_NAME_UNDERSCORED
createdb KALE_NAME_UNDERSCORED_development -U KALE_NAME_UNDERSCORED

kale migrate
